</div>

<div class="current-players" id="current-players">
    <!DOCTYPE html>
    <html lang="ko">

    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>ë˜ë¡±ì“° ì‹œì°¸ì‹œê°„ ê´€ë¦¬ ì‚¬ì´íŠ¸</title>
        <style>
            * {
                margin: 0;
                padding: 0;
                box-sizing: border-box;
            }

            body {
                font-family: 'Arial', sans-serif;
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                min-height: 100vh;
                padding: 20px;
            }

            .container {
                max-width: 1400px;
                margin: 0 auto;
                background: white;
                border-radius: 15px;
                padding: 30px;
                box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            }

            h1 {
                text-align: center;
                color: #333;
                margin-bottom: 30px;
                font-size: 2.5em;
                background: linear-gradient(45deg, #667eea, #764ba2);
                -webkit-background-clip: text;
                -webkit-text-fill-color: transparent;
            }

            .timer-item {
                background: #f8f9fa;
                border: 2px solid #e9ecef;
                border-radius: 12px;
                padding: 20px;
                margin-bottom: 15px;
                display: flex;
                align-items: center;
                justify-content: center;
                gap: 20px;
                transition: all 0.3s ease;
            }

            .timer-item:hover {
                border-color: #667eea;
                box-shadow: 0 5px 15px rgba(102, 126, 234, 0.1);
            }

            .timer-item.active {
                border-color: #28a745;
                background: #f8fff8;
            }

            .input-group {
                display: flex;
                flex-direction: column;
                gap: 5px;
            }

            .input-group label {
                font-size: 12px;
                color: #666;
                font-weight: bold;
            }

            input[type="text"],
            input[type="number"] {
                padding: 10px;
                border: 2px solid #dee2e6;
                border-radius: 8px;
                font-size: 14px;
                transition: border-color 0.3s ease;
            }

            input[type="text"]:focus,
            input[type="number"]:focus {
                outline: none;
                border-color: #667eea;
            }

            .name-input {
                min-width: 140px;
            }

            .time-input {
                min-width: 60px;
                width: auto;
                padding: 8px;
                border: 2px solid #dee2e6;
                border-radius: 8px;
                font-size: 14px;
                transition: border-color 0.3s ease;
                text-align: center;
            }

            .time-input:focus {
                outline: none;
                border-color: #667eea;
            }

            .time-inputs-group {
                display: flex;
                align-items: center;
                gap: 5px;
            }

            .timer-display {
                font-size: 16px;
                font-weight: bold;
                color: #333;
                min-width: 200px;
                text-align: left;
                background: white;
                padding: 12px 15px;
                border-radius: 8px;
                border: 2px solid #e9ecef;
                display: flex;
                align-items: center;
                gap: 15px;
                white-space: nowrap;
            }

            .timer-display.running {
                color: #28a745;
                border-color: #28a745;
            }

            .control-btn {
                padding: 10px 20px;
                border: none;
                border-radius: 8px;
                font-weight: bold;
                cursor: pointer;
                transition: all 0.3s ease;
                font-size: 14px;
            }

            .control-group {
                display: flex;
                gap: 10px;
                margin-left: auto;
            }

            .start-btn {
                background: #28a745;
                color: white;
            }

            .start-btn:hover {
                background: #218838;
            }

            .stop-btn {
                background: #dc3545;
                color: white;
            }

            .stop-btn:hover {
                background: #c82333;
            }

            .delete-btn {
                background: #6c757d;
                color: white;
                padding: 8px 12px;
                font-size: 12px;
            }

            .delete-btn:hover {
                background: #5a6268;
            }

            .usage-log {
                min-width: 200px;
                background: #f8f9fa;
                border: 2px solid #e9ecef;
                border-radius: 8px;
                padding: 12px;
                font-size: 12px;
                color: #666;
            }

            .usage-log-title {
                font-weight: bold;
                margin-bottom: 8px;
                color: #333;
            }

            .usage-log-content {
                max-height: 80px;
                overflow-y: auto;
                line-height: 1.4;
            }

            .usage-log-item {
                margin-bottom: 4px;
                padding: 2px 0;
                border-bottom: 1px solid #eee;
            }

            .usage-log-item:last-child {
                border-bottom: none;
                margin-bottom: 0;
            }

            .add-timer-btn {
                background: linear-gradient(45deg, #667eea, #764ba2);
                color: white;
                border: none;
                padding: 15px 30px;
                border-radius: 10px;
                font-size: 16px;
                font-weight: bold;
                cursor: pointer;
                display: block;
                margin: 20px auto;
                transition: transform 0.3s ease;
            }

            .add-timer-btn:hover {
                transform: translateY(-2px);
            }

            .star-btn {
                background: none;
                border: none;
                font-size: 20px;
                cursor: pointer;
                transition: all 0.3s ease;
                margin-right: 10px;
                color: #ddd;
            }

            .star-btn.active {
                color: #ffd700;
                text-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
            }

            .star-btn:hover {
                transform: scale(1.2);
            }

            .current-players {
                background: linear-gradient(135deg, #e3f2fd 0%, #f3e5f5 100%);
                color: #333;
                border-radius: 12px;
                padding: 20px;
                margin-bottom: 20px;
            }

            .current-players h3 {
                margin-bottom: 15px;
                text-align: center;
                color: #333;
            }

            .player-card {
                background: rgba(255, 255, 255, 0.8);
                border-radius: 8px;
                padding: 15px;
                margin-bottom: 10px;
                display: flex;
                justify-content: space-between;
                align-items: center;
                border: 1px solid rgba(102, 126, 234, 0.2);
            }

            .player-info {
                display: flex;
                align-items: center;
                gap: 10px;
            }

            .player-time {
                font-family: 'Courier New', monospace;
                font-size: 18px;
                font-weight: bold;
                color: #333;
            }

            .no-players {
                text-align: center;
                color: #666;
                font-style: italic;
            }

            @media (max-width: 768px) {
                .timer-item {
                    flex-direction: column;
                    align-items: stretch;
                    gap: 10px;
                }

                .input-group {
                    flex-direction: row;
                    align-items: center;
                    gap: 10px;
                }
            }
        </style>
    </head>

    <body>
        <div class="container">
            <h1>â° ë˜ë¡±ì“° ì‹œì°¸ì‹œê°„ ê´€ë¦¬ ì‚¬ì´íŠ¸</h1>
            <p style="text-align: center; color: #666; font-size: 14px; margin-top: -15px; margin-bottom: 20px;">Made
                by. ê¹€ì¨”ì‘</p>

            <!-- ê¶Œí•œ ìƒíƒœ í‘œì‹œ -->
            <div id="auth-status"
                style="text-align: center; margin-bottom: 20px; padding: 10px; border-radius: 8px; background: #e3f2fd;">
                <span id="user-role">ğŸ‘€ ì¼ë°˜ ì‚¬ìš©ì ëª¨ë“œ (ì¡°íšŒë§Œ ê°€ëŠ¥)</span>
                <button id="admin-login-btn" onclick="showAdminLogin()"
                    style="margin-left: 10px; padding: 5px 15px; border: none; background: #2196f3; color: white; border-radius: 5px; cursor: pointer;">ê´€ë¦¬ì
                    ë¡œê·¸ì¸</button>
            </div>

            <!-- ê´€ë¦¬ì ë¡œê·¸ì¸ ëª¨ë‹¬ -->
            <div id="admin-modal"
                style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1000;">
                <div
                    style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; padding: 30px; border-radius: 15px; text-align: center;">
                    <h3>ğŸ” ê´€ë¦¬ì ë¡œê·¸ì¸</h3>
                    <input type="password" id="admin-password" placeholder="ê´€ë¦¬ì ë¹„ë°€ë²ˆí˜¸ ì…ë ¥"
                        style="padding: 10px; margin: 10px; border: 2px solid #ddd; border-radius: 8px; width: 200px;">
                    <div style="margin-top: 15px;">
                        <button onclick="adminLogin()"
                            style="padding: 10px 20px; background: #4caf50; color: white; border: none; border-radius: 8px; margin-right: 10px; cursor: pointer;">ë¡œê·¸ì¸</button>
                        <button onclick="hideAdminLogin()"
                            style="padding: 10px 20px; background: #f44336; color: white; border: none; border-radius: 8px; cursor: pointer;">ì·¨ì†Œ</button>
                    </div>
                </div>
            </div>

            <!-- ê²€ìƒ‰ ë° ì •ë ¬ ê¸°ëŠ¥ -->
            <div style="background: #f8f9fa; border-radius: 12px; padding: 20px; margin-bottom: 20px;">
                <div style="display: flex; align-items: center; gap: 15px; flex-wrap: wrap;">
                    <div style="flex: 1; min-width: 300px;">
                        <label style="display: block; margin-bottom: 5px; font-weight: bold; color: #333;">ğŸ” ì´ë¦„
                            ê²€ìƒ‰</label>
                        <input type="text" id="search-input" placeholder="ì‹œì²­ì ë‹‰ë„¤ì„ìœ¼ë¡œ ê²€ìƒ‰..."
                            style="width: 100%; padding: 12px; border: 2px solid #dee2e6; border-radius: 8px; font-size: 14px;"
                            oninput="filterTimers()">
                    </div>
                    <div>
                        <label style="display: block; margin-bottom: 5px; font-weight: bold; color: #333;">ğŸ“Š ì •ë ¬
                            ë°©ì‹</label>
                        <select id="sort-select" onchange="renderTimers()"
                            style="padding: 12px; border: 2px solid #dee2e6; border-radius: 8px; font-size: 14px; background: white;">
                            <option value="recent">ìµœê·¼ ì‚¬ìš© ìˆœ</option>
                            <option value="name">ì´ë¦„ ìˆœ (ê°€ë‚˜ë‹¤)</option>
                            <option value="time">ë‚¨ì€ ì‹œê°„ ìˆœ</option>
                            <option value="active">í™œì„± ìƒíƒœ ìˆœ</option>
                        </select>
                    </div>
                    <div>
                        <label style="display: block; margin-bottom: 5px; font-weight: bold; color: #333;">ğŸ“ˆ í†µê³„</label>
                        <div style="font-size: 14px; color: #666;">
                            ì´ <span id="total-count">0</span>ëª… | í‘œì‹œ <span id="visible-count">0</span>ëª…
                        </div>
                    </div>
                </div>
            </div>
            <h3>ğŸ® í˜„ì¬ í”Œë ˆì´ ì¤‘ì¸ ì¸ì›</h3>
            <div id="active-players-list">
                <div class="no-players">í˜„ì¬ í”Œë ˆì´ ì¤‘ì¸ ë©¤ë²„ê°€ ì—†ìŠµë‹ˆë‹¤.</div>
            </div>
        </div>

        <div id="timers-container">
            <!-- íƒ€ì´ë¨¸ í•­ëª©ë“¤ì´ ì—¬ê¸°ì— ì¶”ê°€ë©ë‹ˆë‹¤ -->
        </div>

        <button class="add-timer-btn" onclick="addTimer()" id="add-timer-btn">+ ì¤„ ì¶”ê°€</button>
</div>

<script>
    let timers = [];
    let timerIdCounter = 0;
    let isAdmin = false; // ê´€ë¦¬ì ê¶Œí•œ ìƒíƒœ
    let filteredTimers = []; // í•„í„°ë§ëœ íƒ€ì´ë¨¸ë“¤
    const adminPassword = "ddorong2025"; // ê´€ë¦¬ì ë¹„ë°€ë²ˆí˜¸

    // ê´€ë¦¬ì ë¡œê·¸ì¸ ëª¨ë‹¬ í‘œì‹œ
    function showAdminLogin() {
        document.getElementById('admin-modal').style.display = 'block';
        document.getElementById('admin-password').focus();
    }

    // ê´€ë¦¬ì ë¡œê·¸ì¸ ëª¨ë‹¬ ìˆ¨ê¸°ê¸°
    function hideAdminLogin() {
        document.getElementById('admin-modal').style.display = 'none';
        document.getElementById('admin-password').value = '';
    }

    // ê´€ë¦¬ì ë¡œê·¸ì¸
    function adminLogin() {
        const password = document.getElementById('admin-password').value;
        if (password === adminPassword) {
            isAdmin = true;
            updateAuthStatus();
            hideAdminLogin();
            renderTimers();
            alert('âœ… ê´€ë¦¬ì ë¡œê·¸ì¸ ì„±ê³µ! ëª¨ë“  ê¸°ëŠ¥ì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
        } else {
            alert('âŒ ë¹„ë°€ë²ˆí˜¸ê°€ ì˜ëª»ë˜ì—ˆìŠµë‹ˆë‹¤.');
            document.getElementById('admin-password').value = '';
        }
    }

    // ê´€ë¦¬ì ë¡œê·¸ì•„ì›ƒ
    function adminLogout() {
        isAdmin = false;
        updateAuthStatus();
        renderTimers();
        alert('ğŸ‘‹ ê´€ë¦¬ì ë¡œê·¸ì•„ì›ƒë˜ì—ˆìŠµë‹ˆë‹¤.');
    }

    // ê¶Œí•œ ìƒíƒœ ì—…ë°ì´íŠ¸
    function updateAuthStatus() {
        const userRole = document.getElementById('user-role');
        const loginBtn = document.getElementById('admin-login-btn');

        if (isAdmin) {
            userRole.innerHTML = 'ğŸ”§ ê´€ë¦¬ì ëª¨ë“œ (ìˆ˜ì • ê°€ëŠ¥)';
            loginBtn.innerHTML = 'ë¡œê·¸ì•„ì›ƒ';
            loginBtn.onclick = adminLogout;
            document.getElementById('auth-status').style.background = '#e8f5e8';
        } else {
            userRole.innerHTML = 'ğŸ‘€ ì¼ë°˜ ì‚¬ìš©ì ëª¨ë“œ (ì¡°íšŒë§Œ ê°€ëŠ¥)';
            loginBtn.innerHTML = 'ê´€ë¦¬ì ë¡œê·¸ì¸';
            loginBtn.onclick = showAdminLogin;
            document.getElementById('auth-status').style.background = '#e3f2fd';
        }
    }

    // Enter í‚¤ë¡œ ë¡œê·¸ì¸
    document.addEventListener('keydown', function (event) {
        if (event.key === 'Enter' && document.getElementById('admin-modal').style.display === 'block') {
            adminLogin();
        }
    });

    // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì—ì„œ ë°ì´í„° ë¡œë“œ
    function loadData() {
        const savedTimers = localStorage.getItem('timeManagerTimers');
        if (savedTimers) {
            timers = JSON.parse(savedTimers);
            // ê¸°ì¡´ ë°ì´í„°ì— í•„ë“œê°€ ì—†ìœ¼ë©´ ì¶”ê°€
            timers.forEach(timer => {
                if (timer.totalSeconds === undefined) {
                    timer.totalSeconds = 0;
                }
                if (timer.totalHours === undefined) {
                    timer.totalHours = 0;
                }
                if (timer.isActive === undefined) {
                    timer.isActive = false;
                }
                if (timer.lastUsed === undefined) {
                    timer.lastUsed = Date.now(); // ê¸°ì¡´ ë°ì´í„°ì— í˜„ì¬ ì‹œê°„ìœ¼ë¡œ ì„¤ì •
                }
            });
            timerIdCounter = Math.max(...timers.map(t => t.id), 0) + 1;
            renderTimers();
        } else {
            // ì´ˆê¸° íƒ€ì´ë¨¸ í•˜ë‚˜ ì¶”ê°€
            addTimer();
        }
    }

    // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì— ë°ì´í„° ì €ì¥
    function saveData() {
        localStorage.setItem('timeManagerTimers', JSON.stringify(timers));
    }

    // ìƒˆ íƒ€ì´ë¨¸ ì¶”ê°€
    function addTimer() {
        if (!isAdmin) {
            alert('âŒ ê´€ë¦¬ìë§Œ íƒ€ì´ë¨¸ë¥¼ ì¶”ê°€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
            return;
        }

        const newTimer = {
            id: timerIdCounter++,
            name: '',
            totalHours: 0,
            totalMinutes: 0,
            totalSeconds: 0,
            currentTime: 0,
            isRunning: false,
            isActive: false, // í˜„ì¬ í”Œë ˆì´ ì¤‘ì¸ì§€ ì—¬ë¶€
            startTime: null,
            lastUsed: Date.now(), // ë§ˆì§€ë§‰ ì‚¬ìš© ì‹œê°„ ì¶”ê°€
            usageLog: []
        };

        timers.push(newTimer);
        renderTimers();
        renderActivePlayers();
        saveData();
    }

    // íƒ€ì´ë¨¸ ì‚­ì œ
    function deleteTimer(id) {
        if (!isAdmin) {
            alert('âŒ ê´€ë¦¬ìë§Œ íƒ€ì´ë¨¸ë¥¼ ì‚­ì œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
            return;
        }

        if (confirm('ì •ë§ë¡œ ì´ íƒ€ì´ë¨¸ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
            timers = timers.filter(timer => timer.id !== id);
            renderTimers();
            renderActivePlayers();
            saveData();
        }
    }

    // í”Œë ˆì´ì–´ í™œì„± ìƒíƒœ í† ê¸€
    function togglePlayerActive(id) {
        if (!isAdmin) {
            alert('âŒ ê´€ë¦¬ìë§Œ í”Œë ˆì´ì–´ ìƒíƒœë¥¼ ë³€ê²½í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
            return;
        }

        const timer = timers.find(t => t.id === id);
        if (!timer) return;

        const activePlayers = timers.filter(t => t.isActive).length;

        if (!timer.isActive && activePlayers >= 3) {
            alert('ìµœëŒ€ 3ëª…ê¹Œì§€ë§Œ ë™ì‹œì— í”Œë ˆì´í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤!');
            return;
        }

        timer.isActive = !timer.isActive;
        timer.lastUsed = Date.now(); // ìƒíƒœ ë³€ê²½ ì‹œì—ë„ ìµœê·¼ ì‚¬ìš©ìœ¼ë¡œ ì—…ë°ì´íŠ¸

        // ë¹„í™œì„±í™”ë˜ë©´ íƒ€ì´ë¨¸ë„ ì •ì§€
        if (!timer.isActive && timer.isRunning) {
            toggleTimer(id);
        }

        renderTimers();
        renderActivePlayers();
        saveData();
    }

    // íƒ€ì´ë¨¸ ì‹œì‘/ì •ì§€
    function toggleTimer(id) {
        if (!isAdmin) {
            alert('âŒ ê´€ë¦¬ìë§Œ íƒ€ì´ë¨¸ë¥¼ ì œì–´í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
            return;
        }

        const timer = timers.find(t => t.id === id);
        if (!timer) return;

        // íƒ€ì´ë¨¸ ì‚¬ìš© ì‹œ lastUsed ì—…ë°ì´íŠ¸
        timer.lastUsed = Date.now();

        if (timer.isRunning) {
            // ì •ì§€
            timer.isRunning = false;
            const endTime = Date.now();
            const usedTime = Math.floor((endTime - timer.startTime) / 1000);
            const usedHours = Math.floor(usedTime / 3600);
            const usedMinutes = Math.floor((usedTime % 3600) / 60);

            // ì‚¬ìš© ë¡œê·¸ ì¶”ê°€
            const now = new Date();
            const logEntry = `${now.toLocaleDateString()} ${now.toLocaleTimeString()}: ${usedHours}ì‹œê°„ ${usedMinutes}ë¶„ ì‚¬ìš©`;
            timer.usageLog.unshift(logEntry);

            // ë¡œê·¸ëŠ” ìµœëŒ€ 10ê°œê¹Œì§€ë§Œ ë³´ê´€
            if (timer.usageLog.length > 10) {
                timer.usageLog = timer.usageLog.slice(0, 10);
            }

            timer.startTime = null;
        } else {
            // ì‹œì‘ - ë³´ìœ  ì‹œê°„ì´ ìˆëŠ”ì§€ í™•ì¸
            const totalSeconds = (timer.totalHours * 3600) + (timer.totalMinutes * 60) + timer.totalSeconds;
            if (totalSeconds <= timer.currentTime) {
                alert('ë³´ìœ  ì‹œê°„ì´ ë¶€ì¡±í•©ë‹ˆë‹¤!');
                return;
            }

            timer.isRunning = true;
            timer.startTime = Date.now();
        }

        renderTimers();
        saveData();
    }

    // ì‹œê°„ í˜•ì‹ ë³€í™˜ (ì´ˆ -> ì‹œ:ë¶„:ì´ˆ)
    function formatTime(seconds) {
        // NaN ì²´í¬
        if (isNaN(seconds) || seconds < 0) {
            seconds = 0;
        }

        const hours = Math.floor(seconds / 3600);
        const minutes = Math.floor((seconds % 3600) / 60);
        const secs = seconds % 60;
        return `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
    }

    // íƒ€ì´ë¨¸ ì—…ë°ì´íŠ¸ (ë§¤ì´ˆë§ˆë‹¤ ì‹¤í–‰)
    function updateTimers() {
        let updated = false;
        const now = Date.now();

        timers.forEach(timer => {
            if (timer.isRunning && timer.startTime) {
                const elapsed = Math.floor((now - timer.startTime) / 1000);
                timer.currentTime = Math.min(
                    timer.currentTime + 1,
                    (timer.totalHours * 3600) + (timer.totalMinutes * 60) + timer.totalSeconds
                );

                // ì‹œê°„ì´ ë‹¤ ì†Œëª¨ë˜ë©´ ìë™ ì •ì§€
                if (timer.currentTime >= (timer.totalHours * 3600) + (timer.totalMinutes * 60) + timer.totalSeconds) {
                    timer.isRunning = false;
                    timer.startTime = null;
                    alert(`${timer.name || 'íƒ€ì´ë¨¸'}ì˜ ì‹œê°„ì´ ëª¨ë‘ ì†Œëª¨ë˜ì—ˆìŠµë‹ˆë‹¤!`);
                }

                updated = true;
            }
        });

        if (updated) {
            renderTimers();
            saveData();
        }
    }

    // íƒ€ì´ë¨¸ í•„í„°ë§ ë° ì •ë ¬
    function getFilteredAndSortedTimers() {
        const searchTerm = document.getElementById('search-input')?.value.toLowerCase() || '';
        const sortBy = document.getElementById('sort-select')?.value || 'recent';

        // ê²€ìƒ‰ í•„í„°ë§
        let filtered = timers.filter(timer =>
            timer.name.toLowerCase().includes(searchTerm)
        );

        // ì •ë ¬
        switch (sortBy) {
            case 'recent':
                filtered.sort((a, b) => (b.lastUsed || 0) - (a.lastUsed || 0));
                break;
            case 'name':
                filtered.sort((a, b) => a.name.localeCompare(b.name));
                break;
            case 'time':
                filtered.sort((a, b) => {
                    const aTotal = (a.totalHours * 3600) + (a.totalMinutes * 60) + a.totalSeconds - a.currentTime;
                    const bTotal = (b.totalHours * 3600) + (b.totalMinutes * 60) + b.totalSeconds - b.currentTime;
                    return bTotal - aTotal;
                });
                break;
            case 'active':
                filtered.sort((a, b) => {
                    if (a.isActive && !b.isActive) return -1;
                    if (!a.isActive && b.isActive) return 1;
                    if (a.isRunning && !b.isRunning) return -1;
                    if (!a.isRunning && b.isRunning) return 1;
                    return (b.lastUsed || 0) - (a.lastUsed || 0);
                });
                break;
        }

        return filtered;
    }

    // íƒ€ì´ë¨¸ í•„í„°ë§ (ê²€ìƒ‰)
    function filterTimers() {
        renderTimers();
    }
    // íƒ€ì´ë¨¸ ë Œë”ë§
    function renderTimers() {
        const container = document.getElementById('timers-container');
        container.innerHTML = '';

        // í•„í„°ë§ ë° ì •ë ¬ëœ íƒ€ì´ë¨¸ ê°€ì ¸ì˜¤ê¸°
        filteredTimers = getFilteredAndSortedTimers();

        // í†µê³„ ì—…ë°ì´íŠ¸
        document.getElementById('total-count').textContent = timers.length;
        document.getElementById('visible-count').textContent = filteredTimers.length;

        filteredTimers.forEach(timer => {
            const timerElement = document.createElement('div');
            timerElement.className = `timer-item ${timer.isRunning ? 'active' : ''}`;

            const totalSeconds = (timer.totalHours * 3600) + (timer.totalMinutes * 60) + timer.totalSeconds;
            const remainingSeconds = Math.max(0, totalSeconds - timer.currentTime);

            timerElement.innerHTML = `
                    <button class="star-btn ${timer.isActive ? 'active' : ''}" 
                            onclick="togglePlayerActive(${timer.id})" ${!isAdmin ? 'disabled' : ''}>
                        ${timer.isActive ? 'â­' : 'â˜†'}
                    </button>
                            
                    <div class="input-group">
                        <label>ë‹‰ë„¤ì„(ì‹œì²­ì ë‹‰ë„¤ì„)</label>
                        <input type="text" class="name-input" value="${timer.name}" 
                               onchange="updateTimerName(${timer.id}, this.value)" 
                               placeholder="ì‹œì²­ì ë‹‰ë„¤ì„" ${!isAdmin ? 'readonly' : ''}>
                    </div>
                    
                    <div class="input-group">
                        <label>ë³´ìœ  ì‹œê°„</label>
                        <div class="time-inputs-group">
                            <input type="number" class="time-input" value="${timer.totalHours}" min="0" max="23"
                                   onchange="updateTimerHours(${timer.id}, this.value)" 
                                   placeholder="0" ${!isAdmin ? 'readonly' : ''}>
                            <span>:</span>
                            <input type="number" class="time-input" value="${timer.totalMinutes}" min="0" max="59"
                                   onchange="updateTimerMinutes(${timer.id}, this.value)" 
                                   placeholder="0" ${!isAdmin ? 'readonly' : ''}>
                            <span>:</span>
                            <input type="number" class="time-input" value="${timer.totalSeconds}" min="0" max="59"
                                   onchange="updateTimerSeconds(${timer.id}, this.value)" 
                                   placeholder="0" ${!isAdmin ? 'readonly' : ''}>
                        </div>
                    </div>
                    
                    <div class="timer-display ${timer.isRunning ? 'running' : ''}">
                        <span>ë‚¨ì€ ì‹œê°„</span>
                        <span style="font-family: 'Courier New', monospace; font-size: 18px;">${formatTime(remainingSeconds)}</span>
                    </div>
                    
                    <div class="control-group" ${!isAdmin ? 'style="display: none;"' : ''}>
                        <button class="control-btn ${timer.isRunning ? 'stop-btn' : 'start-btn'}" 
                                onclick="toggleTimer(${timer.id})">
                            ${timer.isRunning ? 'STOP' : 'START'}
                        </button>
                        
                        <button class="control-btn delete-btn" onclick="deleteTimer(${timer.id})">ì‚­ì œ</button>
                    </div>
                    
                    <div class="usage-log">
                        <div class="usage-log-title">ğŸ“ ì‚¬ìš© ê¸°ë¡</div>
                        <div class="usage-log-content">
                            ${timer.usageLog.length > 0 ?
                    timer.usageLog.slice(0, 4).map(log =>
                        `<div class="usage-log-item">${log}</div>`
                    ).join('')
                    : '<div class="usage-log-item" style="color: #999; font-style: italic;">ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤</div>'
                }
                        </div>
                    </div>
                `;

            container.appendChild(timerElement);
        });

        renderActivePlayers();

        // ì¤„ ì¶”ê°€ ë²„íŠ¼ í‘œì‹œ/ìˆ¨ê¸°ê¸°
        const addTimerBtn = document.getElementById('add-timer-btn');
        if (addTimerBtn) {
            addTimerBtn.style.display = isAdmin ? 'block' : 'none';
        }
    }

    // í˜„ì¬ í”Œë ˆì´ ì¤‘ì¸ ë©¤ë²„ë“¤ ë Œë”ë§
    function renderActivePlayers() {
        const activePlayersList = document.getElementById('active-players-list');
        const activePlayers = timers.filter(timer => timer.isActive);

        if (activePlayers.length === 0) {
            activePlayersList.innerHTML = '<div class="no-players">í˜„ì¬ í”Œë ˆì´ ì¤‘ì¸ ë©¤ë²„ê°€ ì—†ìŠµë‹ˆë‹¤.</div>';
            return;
        }

        activePlayersList.innerHTML = activePlayers.map(timer => {
            const totalSeconds = (timer.totalHours * 3600) + (timer.totalMinutes * 60) + timer.totalSeconds;
            const remainingSeconds = Math.max(0, totalSeconds - timer.currentTime);

            return `
                    <div class="player-card">
                        <div class="player-info">
                            <span>â­</span>
                            <span><strong>${timer.name || 'ìµëª… í”Œë ˆì´ì–´'}</strong></span>
                            <span class="${timer.isRunning ? '' : 'no-running'}">${timer.isRunning ? 'ğŸ® í”Œë ˆì´ ì¤‘' : 'â¸ï¸ ëŒ€ê¸° ì¤‘'}</span>
                        </div>
                        <div class="player-time">${formatTime(remainingSeconds)}</div>
                    </div>
                `;
        }).join('');
    }

    // íƒ€ì´ë¨¸ ì´ë¦„ ì—…ë°ì´íŠ¸
    function updateTimerName(id, name) {
        if (!isAdmin) return;

        const timer = timers.find(t => t.id === id);
        if (timer) {
            timer.name = name;
            timer.lastUsed = Date.now(); // ì´ë¦„ ë³€ê²½ ì‹œì—ë„ ìµœê·¼ ì‚¬ìš©ìœ¼ë¡œ ì—…ë°ì´íŠ¸
            saveData();
            renderTimers(); // ì •ë ¬ ì—…ë°ì´íŠ¸ë¥¼ ìœ„í•´ ë‹¤ì‹œ ë Œë”ë§
        }
    }

    // íƒ€ì´ë¨¸ ì‹œê°„ ì—…ë°ì´íŠ¸
    function updateTimerHours(id, hours) {
        if (!isAdmin) return;

        const timer = timers.find(t => t.id === id);
        if (timer) {
            timer.totalHours = parseInt(hours) || 0;
            timer.lastUsed = Date.now(); // ì‹œê°„ ë³€ê²½ ì‹œì—ë„ ìµœê·¼ ì‚¬ìš©ìœ¼ë¡œ ì—…ë°ì´íŠ¸
            saveData();
            renderTimers();
        }
    }

    function updateTimerMinutes(id, minutes) {
        if (!isAdmin) return;

        const timer = timers.find(t => t.id === id);
        if (timer) {
            timer.totalMinutes = parseInt(minutes) || 0;
            timer.lastUsed = Date.now();
            saveData();
            renderTimers();
        }
    }

    function updateTimerSeconds(id, seconds) {
        if (!isAdmin) return;

        const timer = timers.find(t => t.id === id);
        if (timer) {
            timer.totalSeconds = parseInt(seconds) || 0;
            timer.lastUsed = Date.now();
            saveData();
            renderTimers();
        }
    }

    // ì´ˆê¸°í™” ë° ì£¼ê¸°ì  ì—…ë°ì´íŠ¸
    window.onload = function () {
        updateAuthStatus(); // ê¶Œí•œ ìƒíƒœ ì´ˆê¸°í™”
        loadData();
        setInterval(updateTimers, 1000); // ë§¤ì´ˆë§ˆë‹¤ ì—…ë°ì´íŠ¸
    };
</script>
</body>

</html>